% !TEX TS-program = xelatex
% !TEX encoding = UTF-8

\documentclass[11pt, a4paper]{article} % use larger type; default would be 10pt

\usepackage{fontspec} % Font selection for XeLaTeX; see fontspec.pdf for documentation
\defaultfontfeatures{Mapping=tex-text} % to support TeX conventions like ``---''
\usepackage{xunicode} % Unicode support for LaTeX character names (accents, European chars, etc)
\usepackage{xltxtra} % Extra customizations for XeLaTeX
\usepackage{tikz}
\usetikzlibrary{arrows,calc,patterns}

\setmainfont[Ligatures=TeX]{Garamond} % set the main body font (\textrm), assumes Charis SIL is installed
%\setsansfont{Deja Vu Sans}
\setmonofont[Ligatures=TeX]{Fira Code}

% other LaTeX packages.....
\usepackage{fullpage}
\usepackage[top=2cm, bottom=4.5cm, left=2.5cm, right=2.5cm]{geometry}
\usepackage{amsmath,amsthm,amsfonts,amssymb,amscd,systeme}
\usepackage{cancel}
\geometry{a4paper} 
%\usepackage[parfill]{parskip} % Activate to begin paragraphs with an empty line rather than an indent
\usepackage{fancyhdr}
\usepackage{listings}
\usepackage{graphicx}
\usepackage{hyperref}
\usepackage{multicol}

\renewcommand\lstlistingname{Algorithm}
\renewcommand\lstlistlistingname{Algorithms}
\def\lstlistingautorefname{Alg.}
\lstdefinestyle{mystyle}{
    % backgroundcolor=\color{backcolour},   
    % commentstyle=\color{codegreen},
    % keywordstyle=\color{magenta},
    % numberstyle=\tiny\color{codegray},
    % stringstyle=\color{codepurple},
    basicstyle=\ttfamily\footnotesize,
    breakatwhitespace=false,         
    breaklines=true,                 
    captionpos=b,                    
    keepspaces=true,                 
    numbers=left,                    
    numbersep=5pt,                  
    showspaces=false,                
    showstringspaces=false,
    showtabs=false,                  
    tabsize=2
}
\lstset{style=mystyle}

\newcommand\course{5 - Матфіз}
\newcommand\hwnumber{ДЗ №5}                   % <-- homework number
\newcommand\idgroup{ФІ-91}                
\newcommand\idname{Михайло Корешков}  

\usepackage[framemethod=TikZ]{mdframed}
\mdfsetup{%
	backgroundcolor = black!5,
}
\mdfdefinestyle{ans}{%
    backgroundcolor = green!5,
    linecolor = green!50,
    linewidth = 1pt,
}

\pagestyle{fancyplain}
\headheight 35pt
\lhead{\idgroup \\ \idname}
\chead{\textbf{\Large \hwnumber}}
\rhead{\course \\ \today}
\lfoot{}
\cfoot{}
\rfoot{\small\thepage}
\headsep 1.5em

\linespread{1.2}

\begin{document}

%  N24

\section*{№ 24}

\begin{mdframed}
    \begin{equation}
        \begin{cases}
            u_t=11u_{xx} + 24e^{-44t}\sin 4x;\\
            u(x,0) = 0;\\
            u(0,t) = u(\pi,t) = 0
        \end{cases}    
    \end{equation}
\end{mdframed}

\begin{mdframed}[backgroundcolor=violet!25]
    Ця задача має граничні умови першого роду праворуч та ліворуч.
\end{mdframed}

Спочатку розв'язуємо однорідне рівняння методом розділення змінних.\\
Нехай
\begin{equation}
    u(x,t) = X(x)T(t)
\end{equation}

Рівняння 1 приймає наступний вигляд:
\begin{equation}
    X(x) T'(t) = 11 X''(x) T(t) \; | \cdot \frac{1}{11 X(x)T(t)}
\end{equation}

\begin{equation}
    \frac{T'(t)}{11\cdot T(t)} = \frac{X''(x)}{X(x)} = \text{const} = -\Lambda
\end{equation}

\begin{equation}
    \begin{cases}
        T'(t) = -11\Lambda\cdot T(t);\\
        X''(x) + \Lambda \cdot X(x) = 0
    \end{cases}
\end{equation}

Розглядаємо різні значення $\Lambda$:

\subsection*{$\Lambda=0$}
\begin{equation}
    \begin{cases}
        X''(x) = 0\\
        X(0) = X(1) = 0
    \end{cases} \implies X(x) = 0
\end{equation}

Тобто лише тривіальний розв'язок

\subsection*{$\Lambda<0$}

$$
    \begin{cases}
        X''(x) = |\Lambda| \cdot X(x)\\
        X(0) = X(1) = 0
    \end{cases}
$$


$$X(x) = A \cosh \sqrt{-\Lambda}x + B \sinh \sqrt{-\Lambda}x$$
$$X(0) = A + 0 = 0 \implies A = 0$$
$$X(1) = B \sinh \sqrt{-\Lambda}x = 0 \implies B = 0$$

Тобто лише тривіальний розв'язок

\textbf{Отже, розглядаємо лише $\Lambda > 0$}

\subsection*{$\Lambda > 0$}

$$X''(x) + \Lambda \cdot X(x) = 0 \implies$$
\begin{equation}
    X(x) = A \cos \sqrt{\Lambda}x + B \sin \sqrt{\Lambda}x
\end{equation}


$$X(0) = A + 0 = 0 \implies A = 0$$
$$X(\pi) = B \sin \pi\sqrt{\Lambda} = 0 \implies$$
\begin{equation}
    \Lambda_n = (n)^2;
\end{equation}
\begin{equation}
    X_n(x) = \sin \pi n x
\end{equation}

$$T'(t) = - 11 \Lambda \cdot T(t)$$
\begin{equation}
    T_n(t) = e^{-11 n^2 t}
\end{equation}

Отже,
\begin{equation}
    u_n(x,t) = e^{-11 n^2 t} \sin \pi n x
\end{equation}

Нагадую умову:
$$
\begin{cases}
    u_t - 11u_{xx} = 24e^{-44t}\sin 4x;\\
    u(x,0) = 0;\\
    u(0,t) = u(\pi,t) = 0
\end{cases}  
$$

Розв'язком неоднорідного ДР є сума загального розв'язку однорідного та часткового розв'язку неоднорідного.
Шукаємо частковий розв'язок.

$$u_p(x,t) = e^{-Dt}(A\sin Cx + B\cos Cx)$$
$$-De^{-Dt}(A\sin Cx + B\cos Cx) + 11 C^2 e^{-Dt} (A \sin Cx + B \cos Cx) = 24 e^{-Dt} \sin 4x$$
Зрозуміло, що $D = 44$. Одразу ділимо все на $e^{-44t}$.

$$-44(A\sin Cx + B\cos Cx) + 11 C^2 (A \sin Cx + B \cos Cx) = 24 \sin 4x$$
Зрозуміло, що $B = 0, C = 4$.
$$-44 A\sin 4x + 11 \cdot 16 \cdot A \sin 4x = 24 \sin 4x$$
$$A(176 - 44) \sin 4x = 24 \sin 4x$$
$$132 A = 24$$
Маємо $A = \frac{24}{132} = \frac{2}{11}$

Тобто $$u_p(x,t) = \frac{2}{11}e^{-44t}\sin 4x$$

Тобто загальний розв'язок (1) має бути
$$u(x,t) = \sum_n a_n u_n(x,t) + u_p(x,t)$$

Залишається лише підставити умову $u(x,0)=0$

$$u(x,0) = \sum_n a_n \sin \pi n x + \frac{2}{11}\sin 4x = 0\quad (\forall x\in[0,\pi])$$
$$\sum_n a_n \sin \pi n x = - \frac{2}{11}\sin 4x$$

$$a_4 = -\frac{2}{11}$$

Підставляємо назад

$$u(x,t) = -\frac{2}{11}u_4(x,t) + \frac{2}{11}e^{-44t}\sin 4x$$
$$u(x,t) = \frac{2}{11}\sin 4x \left(e^{-44t} - e^{-11\cdot 16 \cdot t}\right) $$

\begin{mdframed}[style=ans]
$$u(x,t) = \frac{2}{11}\sin 4x \left(e^{-44t} - e^{-176t}\right) $$
\end{mdframed}

\end{document}

